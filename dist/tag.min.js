var Tag=function(){function t(t){return"string"==typeof t&&t.trim().length>0}function e(t){var e,r,n,i={};if(!t||t.length<1)return i;for(r=0,n=t.length;n>r;r+=1)e=t[r].replace(/['\"\[\]]/g,"").split("="),i[e[0]]=e[1];return i}function r(t){var r="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",n="[\\x20\\t\\r\\n\\f]",i=r.replace("w","w#"),s=t.match(new RegExp("("+r.replace("w","w*")+")")),o=t.match(new RegExp("\\.("+r+")","g")),a=t.match(new RegExp("#("+r+")")),h=t.match(new RegExp("\\["+n+"*("+r+")"+n+"*(?:([*^$|!~]?=)"+n+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+i+")|)|)"+n+"*\\]","g"));return h=e(h),o=!o||o.length<1?"":o.join(" ").replace(/\./g,""),a=a?a[0].replace("#",""):void 0,o&&(h["class"]=o),a&&(h.id=a),{tag:s[0],attributes:h}}function n(t,e){var r=e.attributes;for(var n in r){var i=r[n];i&&t.setAttribute(n,i)}return t}function i(t){var e=document.createElement(t.name),r=document.createDocumentFragment();return t.children.length?(t.children.forEach(function(t){r.appendChild(i(t))}),e.appendChild(r)):e.innerText=t.innerText,n(e,t)}var s,o=/area|base|basefont|br|hr|input|img|link|meta/;return s=function(t){var e=r(t);this.name=e.tag,this.attributes=e.attributes,this.innerText="",this.children=[]},s.prototype.add=function(){var t,e,r=Array.prototype.slice.call(arguments);if(r.length)for(t=0,e=r.length;e>t;t+=1)this.children.push(r[t]);return this},s.prototype.getAttr=function(e){return t(e)?this.attributes[e]:void 0},s.prototype.setAttr=function(e,r){return t(e)&&t(r)&&(this.attributes[e]=r),this},s.prototype.addIf=function(t,e){return e instanceof s?t?this.add(e):this:void 0},s.prototype.setText=function(t){return this.innerText=String(t),this},s.prototype.addClass=function(t){var e=this.attributes["class"];return-1===e.indexOf(t)&&(this.attributes["class"]+=[" ",t].join("")),this},s.prototype.removeClass=function(e){var r,n=this.attributes["class"];return t(e)?(t(n)&&(n=n.split(" "),r=n.indexOf(e),r>-1&&(n.splice(r,1),this.attributes["class"]=n.join(" "))),this):this},s.prototype.removeClassIf=function(e,r){return e&&t(r)?this.removeClass(r):this},s.prototype.removeAttr=function(t){return delete this.attributes[t],this},s.prototype.removeAttrIf=function(e,r){return e&&t(r)?this.removeAttr(r):this},s.prototype.addAttr=function(e,r){var n;if("object"==typeof e){for(n in e)e.hasOwnProperty(n)&&!this.attributes[n]&&(this.attributes[n]=e[n]);return this}return t(e)&&t(r)&&(this.attributes[n]||(this.attributes[e]=r)),this},s.prototype.addAttrIf=function(t,e,r){return t?this.addAttr(e,r):this},s.prototype.addClassIf=function(t,e){return t?this.addClass(e):this},s.prototype.render=function(t){var e,r,n,s="",a=t||{format:"HTMLElement"},h=this.attributes,u=["<",this.name],p=this.children,c=o.test(this.name);if(window&&window.document&&"HTMLElement"===a.format)return i(this);if(h)for(n in h)h.hasOwnProperty(n)&&h[n]&&u.push(" ",n,'="',h[n],'"');if(c){if(u.push(" />"),p.length)throw["Nested content was provided for the tag name: ",this.name].join("")}else{for(u.push(">"),e=0,r=p.length;r>e;e+=1)s+="string"==typeof p[e]?p[e]:p[e].render();this.innerText.length>0&&u.push(this.innerText),s.length>0&&u.push(s),u.push(["</",this.name,">"].join(""))}return u.join("")},function(e){if(!t(e))throw"The selector provided does not supply a valid tag";return new s(e)}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhZy5qcyJdLCJuYW1lcyI6WyJUYWciLCJpc1N0cmluZyIsInN0ciIsInRyaW0iLCJsZW5ndGgiLCJ0b2tlbml6ZUF0dHJpYnV0ZXMiLCJhdHRycyIsInNwbGl0IiwiaSIsImoiLCJhdHRyaWJ1dGVzIiwicmVwbGFjZSIsInBhcnNlU2VsZWN0b3IiLCJzZWxlY3RvciIsImNoYXJhY3RlckVuY29kaW5nIiwid2hpdGVzcGFjZSIsImlkZW50aWZpZXIiLCJ0YWciLCJtYXRjaCIsIlJlZ0V4cCIsImNsYXNzZXMiLCJpZCIsImpvaW4iLCJ1bmRlZmluZWQiLCJzZXRFbGVtZW50QXR0cmlidXRlcyIsImVsZW1lbnQiLCJhdHRyIiwidmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJET01GcmFnbWVudCIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm5hbWUiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJjaGlsZHJlbiIsImZvckVhY2giLCJjaGlsZCIsImFwcGVuZENoaWxkIiwiaW5uZXJUZXh0IiwiU0VMRl9DTE9TSU5HX1RBR1MiLCJlbGVtZW50VG9rZW5zIiwidGhpcyIsInByb3RvdHlwZSIsImFkZCIsImFyZ3MiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImFyZ3VtZW50cyIsInB1c2giLCJnZXRBdHRyIiwic2V0QXR0ciIsImFkZElmIiwiY29uZGl0aW9uIiwic2V0VGV4dCIsInRleHQiLCJTdHJpbmciLCJhZGRDbGFzcyIsImNsYXNzTmFtZSIsImNsYXNzQXR0ciIsImluZGV4T2YiLCJyZW1vdmVDbGFzcyIsImF0dHJJbmRleCIsInNwbGljZSIsInJlbW92ZUNsYXNzSWYiLCJyZW1vdmVBdHRyIiwiYXR0cmlidXRlIiwicmVtb3ZlQXR0cklmIiwiYWRkQXR0ciIsImhhc093blByb3BlcnR5IiwiYWRkQXR0cklmIiwiYWRkQ2xhc3NJZiIsInJlbmRlciIsImNvbmZpZyIsImlubmVySHRtbCIsIm9wdGlv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dEUsQ0FHTCxJQUZBeUQsRUFBTzVCLEtBQUssS0FFUDNDLEVBQUksRUFBR0MsRUFBSTJCLEVBQVNoQyxPQUFZSyxFQUFKRCxFQUFPQSxHQUFLLEVBRTNDb0UsR0FBb0MsZ0JBQWhCeEMsR0FBUzVCLEdBQWtCNEIsRUFBUzVCLEdBQUs0QixFQUFTNUIsR0FBR2tFLFFBR3hFL0IsTUFBS0gsVUFBVXBDLE9BQVMsR0FDekIyRSxFQUFPNUIsS0FBS1IsS0FBS0gsV0FHaEJvQyxFQUFVeEUsT0FBUyxHQUNwQjJFLEVBQU81QixLQUFLeUIsR0FHZEcsRUFBTzVCLE1BQU0sS0FBTVIsS0FBS1YsS0FBTSxLQUFLWCxLQUFLLEtBRzFDLE1BQU95RCxHQUFPekQsS0FBSyxLQUdkLFNBQVNULEdBQ2QsSUFBSVosRUFBU1ksR0FDWCxLQUFNLG1EQUdSLE9BQU8sSUFBSWIsR0FBSWEiLCJmaWxlIjoidGFnLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBUYWcgPSAoZnVuY3Rpb24oKXtcbiAgdmFyIFNFTEZfQ0xPU0lOR19UQUdTID0gL2FyZWF8YmFzZXxiYXNlZm9udHxicnxocnxpbnB1dHxpbWd8bGlua3xtZXRhLyxcbiAgVGFnO1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIGFuIGFyZ3VtZW50IGlzIG9mIHR5cGUgc3RyaW5nIGFuZCBoYXMgYSB2YWxpZCBsZW5ndGhcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtICB7U3RyaW5nfSAgc3RyIEEgc3RyaW5nIG9mIHRleHRcbiAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICovXG4gIGZ1bmN0aW9uIGlzU3RyaW5nKHN0cikge1xuICAgIHJldHVybiB0eXBlb2Ygc3RyID09PSAnc3RyaW5nJyAmJiBzdHIudHJpbSgpLmxlbmd0aCA+IDA7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICogVHJhbnNmb3JtcyBhbiBhcnJheSBvZiBET00tc3R5bGUgYXR0cmlidXRlcyhlLmcuIGNsYXNzPVwiZm9vXCIpIHRvIGEgaGFzaCB0YWJsZVxuICAgKiBAcGFyYW0gIHtTdHJpbmdbXX0gYXR0cnMgQW4gYXJyYXkgb2YgRE9NLXN0eWxlIGF0dHJpYnV0ZXNcbiAgICogQHJldHVybiB7T2JqZWN0fVxuICAgKi9cbiAgZnVuY3Rpb24gdG9rZW5pemVBdHRyaWJ1dGVzKGF0dHJzKSB7XG4gICAgdmFyIGF0dHJpYnV0ZXMgPSB7fSxcbiAgICAgIHNwbGl0LFxuICAgICAgaSxcbiAgICAgIGo7XG5cbiAgICBpZighYXR0cnMgfHwgYXR0cnMubGVuZ3RoIDwgMSkge1xuICAgICAgcmV0dXJuIGF0dHJpYnV0ZXM7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMCwgaiA9IGF0dHJzLmxlbmd0aDsgaSA8IGo7IGkgKz0gMSkge1xuICAgICAgc3BsaXQgPSBhdHRyc1tpXS5yZXBsYWNlKC9bJ1xcXCJcXFtcXF1dL2csICcnKS5zcGxpdCgnPScpO1xuICAgICAgYXR0cmlidXRlc1tzcGxpdFswXV0gPSBzcGxpdFsxXTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBNZXRpY3Vsb3VzbHkgcGFyc2VzIHRoZSBDU1Mtc3R5bGUgc2VsZWN0b3IgcHJvdmlkZWQgYW5kIHByb2R1Y2VzIGFuIE9iamVjdFxuICAgKiBjb25zaXN0aW5nIG9mIGEgdGFnIG5hbWUgYW5kIHRoZSBwcm92aWRlZCBhdHRyaWJ1dGVzXG4gICAqIEBwYXJhbSAge1N0cmluZ30gc2VsZWN0b3IgVGhlIG9yaWdpbmFsIENTUy1zdHlsZSAoU2l6emxlLXN0eWxlKSBzZWxlY3RvclxuICAgKiBAcmV0dXJuIHtPYmplY3R9ICAgICAgICAgIFRoZSB0cmFuc2Zvcm1lZCBtZXRhIG9iamVjdCBmb3IgdGhlIHNlbGVjdG9yXG4gICAqL1xuICBmdW5jdGlvbiBwYXJzZVNlbGVjdG9yKHNlbGVjdG9yKSB7XG4gICAgdmFyIGNoYXJhY3RlckVuY29kaW5nID0gJyg/OlxcXFxcXFxcLnxbXFxcXHctXXxbXlxcXFx4MDAtXFxcXHhhMF0pKycsXG4gICAgICB3aGl0ZXNwYWNlID0gJ1tcXFxceDIwXFxcXHRcXFxcclxcXFxuXFxcXGZdJyxcbiAgICAgIGlkZW50aWZpZXIgPSBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCd3JywgJ3cjJyksXG4gICAgICB0YWcgPSBzZWxlY3Rvci5tYXRjaChuZXcgUmVnRXhwKCcoJyArIGNoYXJhY3RlckVuY29kaW5nLnJlcGxhY2UoJ3cnLCAndyonICkgKyAnKScpKSxcbiAgICAgIC8vVE9ETzogQ2xhc3NlcyBSZWdFeCBuZWVkcyB0byBhY2NvdW50IGZvciBVUkxzIGFuZCBvdGhlciAncGVyaW9kcycgaW4gdGhlIHNlbGVjdG9yIHRoYXQgYXJlbid0IGNsYXNzZXNcbiAgICAgIGNsYXNzZXMgPSBzZWxlY3Rvci5tYXRjaChuZXcgUmVnRXhwKCdcXFxcLignICsgY2hhcmFjdGVyRW5jb2RpbmcgKyAnKScsICdnJykpLFxuICAgICAgaWQgPSBzZWxlY3Rvci5tYXRjaChuZXcgUmVnRXhwKCAnIygnICsgY2hhcmFjdGVyRW5jb2RpbmcgKyAnKScpKSxcbiAgICAgIGF0dHJpYnV0ZXMgPSBzZWxlY3Rvci5tYXRjaChuZXcgUmVnRXhwKCBcIlxcXFxbXCIgKyB3aGl0ZXNwYWNlICsgXCIqKFwiICsgY2hhcmFjdGVyRW5jb2RpbmcgKyBcIilcIiArIHdoaXRlc3BhY2UgKyBcIiooPzooWypeJHwhfl0/PSlcIiArIHdoaXRlc3BhY2UgKyBcIiooPzooWydcXFwiXSkoKD86XFxcXFxcXFwufFteXFxcXFxcXFxdKSo/KVxcXFwzfChcIiArIGlkZW50aWZpZXIgKyBcIil8KXwpXCIgKyB3aGl0ZXNwYWNlICsgXCIqXFxcXF1cIiwgXCJnXCIpKTtcblxuICAgIGF0dHJpYnV0ZXMgPSB0b2tlbml6ZUF0dHJpYnV0ZXMoYXR0cmlidXRlcyk7XG4gICAgY2xhc3NlcyA9ICFjbGFzc2VzIHx8IGNsYXNzZXMubGVuZ3RoIDwgMSA/ICcnIDogY2xhc3Nlcy5qb2luKCcgJykucmVwbGFjZSgvXFwuL2csICcnKTtcbiAgICBpZCA9ICFpZCA/IHVuZGVmaW5lZCA6IGlkWzBdLnJlcGxhY2UoJyMnLCAnJyk7XG5cbiAgICBpZihjbGFzc2VzKSB7XG4gICAgICBhdHRyaWJ1dGVzWydjbGFzcyddID0gY2xhc3NlcztcbiAgICB9XG5cbiAgICBpZihpZCkge1xuICAgICAgYXR0cmlidXRlcy5pZCA9IGlkO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0YWcgOiB0YWdbMF0sXG4gICAgICBhdHRyaWJ1dGVzOiBhdHRyaWJ1dGVzXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHRoZSBwcm92aWRlZCBET00gYXR0cmlidXRlcyB0byB0aGUgZWxlbWVudCBmcm9tIHRoZSBwcm92aWRlZCB0YWcncyBtZXRhIGluZm9ybWF0aW9uXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcbiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gdGFnXG4gICAqL1xuICBmdW5jdGlvbiBzZXRFbGVtZW50QXR0cmlidXRlcyhlbGVtZW50LCB0YWcpIHtcbiAgICB2YXIgYXR0cmlidXRlcyA9IHRhZy5hdHRyaWJ1dGVzO1xuXG4gICAgZm9yKHZhciBhdHRyIGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGF0dHJpYnV0ZXNbYXR0cl07XG5cbiAgICAgIGlmKHZhbHVlKSB7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW5kZXJzIGFuIEhUTUxFTGVtZW50LXZlcnNpb24gb2YgdGhlIHRhZyBhbmQgYW55IGNoaWxkcmVuLCByZWN1cnNpdmVseS5cbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtICB7dGFnfSB0YWcgQW4gaW5zdGFuY2Ugb2YgdGhlIFRhZyBvYmplY3RcbiAgICogQHJldHVybiB7SFRNTEVsZW1lbnR9ICAgICBUaGUgcmVzdWx0aW5nIEhUTUxFbGVtZW50XG4gICAqL1xuICBmdW5jdGlvbiByZW5kZXJET01GcmFnbWVudCh0YWcpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcubmFtZSksXG4gICAgICBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgIGlmKCF0YWcuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICBjb250YWluZXIuaW5uZXJUZXh0ID0gdGFnLmlubmVyVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFnLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQocmVuZGVyRE9NRnJhZ21lbnQoY2hpbGQpKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgIH1cblxuICAgIHJldHVybiBzZXRFbGVtZW50QXR0cmlidXRlcyhjb250YWluZXIsIHRhZyk7XG4gIH1cblxuICAvKipcbiAgICogQyd0b3JcbiAgIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IHNlbGVjdG9yIFRoZSBDU1Mtc3R5bGUgc2VsZWN0b3IgdGhhdCBkZWZpbmVzIHRoZSB0YWcgdG8gYmVcbiAgICogY3JlYXRlZFxuICAgKiBAcmV0dXJuIHtPYmplY3R9ICAgICAgICAgIFRoZSBtZXRhIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHRhZ1xuICAgKi9cbiAgVGFnID0gZnVuY3Rpb24oc2VsZWN0b3Ipe1xuICAgIHZhciBlbGVtZW50VG9rZW5zID0gcGFyc2VTZWxlY3RvcihzZWxlY3Rvcik7XG5cbiAgICB0aGlzLm5hbWUgPSBlbGVtZW50VG9rZW5zLnRhZztcbiAgICB0aGlzLmF0dHJpYnV0ZXMgPSBlbGVtZW50VG9rZW5zLmF0dHJpYnV0ZXM7XG4gICAgdGhpcy5pbm5lclRleHQgPSAnJztcbiAgICB0aGlzLmNoaWxkcmVuID0gW107XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBjaGlsZCB0YWcgdG8gdGhlIHRhZ1xuICAgKiBAcmV0dXJuIHtUYWd9IFRoaXMgdGFnIGluc3RhbmNlXG4gICAqL1xuICBUYWcucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLFxuICAgICAgaSwgajtcblxuICAgIGlmKGFyZ3MubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBqID0gYXJncy5sZW5ndGg7IGkgPCBqOyBpICs9IDEpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKGFyZ3NbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBwcm92aWRlZCBhdHRyaWJ1dGVcbiAgICogQHBhcmFtICB7U3RyaW5nfSBhdHRyIFRoZSBhdHRyaWJ1dGUga2V5XG4gICAqIEByZXR1cm4ge1N0cmluZ30gICAgICBUaGUgdmFsdWUgb2YgdGhlIGF0dHJpYnV0ZVxuICAgKi9cbiAgVGFnLnByb3RvdHlwZS5nZXRBdHRyID0gZnVuY3Rpb24oYXR0cikge1xuICAgIGlmKGlzU3RyaW5nKGF0dHIpKSB7XG4gICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW2F0dHJdO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogU2V0cyB0aGUgdmFsdWUgb2YgdGhlIHByb3ZpZGVkIGF0dHJpYnV0ZS4gVW5saWtlIFRhZy5wcm90b3R5cGUuYWRkQXR0cixcbiAgICogVGhpcyBtZXRob2QgaXMgZGVzdHJ1Y3RpdmUuXG4gICAqIEBwYXJhbSAge1N0cmluZ30gYXR0ciAgVGhlIGF0dHJpYnV0ZSBrZXkgdG8gYWRkIHRvIHRoZSBUYWdcbiAgICogQHBhcmFtICB7U3RyaW5nfSB2YWx1ZSBUaGUgdmFsdWUgb2YgdGhlIGF0dHJpYnV0ZSB0byBhZGQgdG8gdGhlIFRhZ1xuICAgKiBAcmV0dXJuIHt0YWd9ICAgICAgIFRoaXMgaW5zdGFuY2Ugb2YgdGhlIHRhZ1xuICAgKi9cbiAgVGFnLnByb3RvdHlwZS5zZXRBdHRyID0gZnVuY3Rpb24oYXR0ciwgdmFsdWUpIHtcbiAgICBpZihpc1N0cmluZyhhdHRyKSAmJiBpc1N0cmluZyh2YWx1ZSkpIHtcbiAgICAgIHRoaXMuYXR0cmlidXRlc1thdHRyXSA9IHZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJZiB0aGUgcHJvdmlkZWQgY29uZGl0aW9uIGlzIHRydWUsIGFkZCB0aGUgY2hpbGQgdGFnXG4gICAqIEBwYXJhbSAge0Jvb2xlYW59IGNvbmRpdGlvbiAgVGhlIGNvbmRpdGlvblxuICAgKiBAcGFyYW0gIHtUYWd9IHRhZyAgICAgICAgICAgIFRoZSBpbnN0YW5jZSBvZiB0aGUgY2hpbGQgdGFnXG4gICAqIEByZXR1cm4ge1RhZ30gICAgICAgICAgICAgICAgVGhpcyBjdXJyZW50IHRhZyBpbnN0YW5jZVxuICAgKi9cbiAgVGFnLnByb3RvdHlwZS5hZGRJZiA9IGZ1bmN0aW9uKGNvbmRpdGlvbiwgdGFnKSB7XG4gICAgaWYodGFnIGluc3RhbmNlb2YgVGFnKSB7XG4gICAgICByZXR1cm4gY29uZGl0aW9uID8gdGhpcy5hZGQodGFnKSA6IHRoaXM7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBpbm5lclRleHQgb2YgdGhlIHRhZy4gVXNlZnVsIGZvciBlbGVtZW50cyB3aXRoIG5vIGNoaWxkcmVuXG4gICAqIHdobyBoYXZlIGEgdGV4dCB2YWx1ZVxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IHRleHQgVGhlIHRleHQgdmFsdWUgb2YgdGhlIHRhZ1xuICAgKiBAcmV0dXJuIHtUYWd9ICAgICAgVGhpcyBpbnN0YW5jZSBvZiB0aGUgdGFnXG4gICAqL1xuICBUYWcucHJvdG90eXBlLnNldFRleHQgPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgdGhpcy5pbm5lclRleHQgPSBTdHJpbmcodGV4dCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBhIENTUyBjbGFzcyB0byB0aGUgdGFnXG4gICAqIEBwYXJhbSAge1N0cmluZ30gY2xhc3NOYW1lIFRoZSBDU1MgY2xhc3MgbmFtZVxuICAgKiBAcmV0dXJuIHtUYWd9ICAgICAgICAgICBUaGlzIGluc3RhbmNlIG9mIHRoZSB0YWdcbiAgICovXG4gIFRhZy5wcm90b3R5cGUuYWRkQ2xhc3MgPSBmdW5jdGlvbihjbGFzc05hbWUpIHtcbiAgICB2YXIgY2xhc3NBdHRyID0gdGhpcy5hdHRyaWJ1dGVzWydjbGFzcyddO1xuXG4gICAgaWYoY2xhc3NBdHRyLmluZGV4T2YoY2xhc3NOYW1lKSA9PT0gLTEpIHtcbiAgICAgIHRoaXMuYXR0cmlidXRlc1snY2xhc3MnXSArPSBbJyAnLCBjbGFzc05hbWVdLmpvaW4oJycpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGEgQ1NTIGNsYXNzIGZyb20gdGhlIHRhZ1xuICAgKiBAcGFyYW0gIHtTdHJpbmd9IGNsYXNzTmFtZSBUaGUgQ1NTIGNsYXNzIG5hbWVcbiAgICogQHJldHVybiB7VGFnfSAgICAgICAgICAgVGhpcyBpbnN0YW5jZSBvZiB0aGUgdGFnXG4gICAqL1xuICBUYWcucHJvdG90eXBlLnJlbW92ZUNsYXNzID0gZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gICAgdmFyIGNsYXNzZXMgPSB0aGlzLmF0dHJpYnV0ZXNbJ2NsYXNzJ10sXG4gICAgICBhdHRySW5kZXg7XG5cbiAgICBpZighaXNTdHJpbmcoY2xhc3NOYW1lKSkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgaWYoaXNTdHJpbmcoY2xhc3NlcykpIHtcbiAgICAgIGNsYXNzZXMgPSBjbGFzc2VzLnNwbGl0KCcgJyk7XG4gICAgICBhdHRySW5kZXggPSBjbGFzc2VzLmluZGV4T2YoY2xhc3NOYW1lKTtcblxuICAgICAgIGlmKGF0dHJJbmRleCA+IC0xKSB7XG4gICAgICAgICBjbGFzc2VzLnNwbGljZShhdHRySW5kZXgsIDEpO1xuICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzWydjbGFzcyddID0gY2xhc3Nlcy5qb2luKCcgJyk7XG4gICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIENTUyBjbGFzcyBpZiB0aGUgcHJvdmlkZWQgY29uZGl0aW9uIGlzIHRydWVcbiAgICogQHBhcmFtICB7Qm9vbGVhbn0gY29uZGl0aW9uIFRoZSBjb25kaXRpb25cbiAgICogQHBhcmFtICB7U3RyaW5nfSBjbGFzc05hbWUgVGhlIGNsYXNzIG5hbWUgdG8gcmVtb3ZlIGZyb20gdGhlIHRhZ1xuICAgKiBAcmV0dXJuIHtUYWd9ICAgICAgICAgICBUaGlzIGluc3RhbmNlIG9mIHRoZSBjbGFzc1xuICAgKi9cbiAgVGFnLnByb3RvdHlwZS5yZW1vdmVDbGFzc0lmID0gZnVuY3Rpb24oY29uZGl0aW9uLCBjbGFzc05hbWUpIHtcbiAgICByZXR1cm4gY29uZGl0aW9uICYmIGlzU3RyaW5nKGNsYXNzTmFtZSkgPyB0aGlzLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSkgOiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIHByb3ZpZGVkIGF0dHJpYnV0ZSBmcm9tIHRoZSB0YWdcbiAgICogQHBhcmFtICB7U3RyaW5nfSBhdHRyaWJ1dGUgVGhlIGF0dHJpYnV0ZSBrZXlcbiAgICogQHJldHVybiB7VGFnfSAgICAgICAgICAgVGhpcyB0YWcgaW5zdGFuY2VcbiAgICovXG4gIFRhZy5wcm90b3R5cGUucmVtb3ZlQXR0ciA9IGZ1bmN0aW9uKGF0dHJpYnV0ZSkge1xuICAgIGRlbGV0ZSB0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBwcm92aWRlZCBhdHRyaWJ1dGUgaWYgdGhlIHByb3ZpZGVkIGNvbmRpdGlvbiBpcyB0cnVlXG4gICAqIEBwYXJhbSAge0Jvb2xlYW59IGNvbmRpdGlvbiBUaGUgY29uZGl0aW9uXG4gICAqIEBwYXJhbSAge1N0cmluZ30gYXR0cmlidXRlIFRoZSBrZXkgb2YgdGhlIGF0dHJpYnV0ZSB0byByZW1vdmVcbiAgICogQHJldHVybiB7VGFnfSAgICAgICAgICAgVGhpcyB0YWcgaW5zdGFuY2VcbiAgICovXG4gIFRhZy5wcm90b3R5cGUucmVtb3ZlQXR0cklmID0gZnVuY3Rpb24oY29uZGl0aW9uLCBhdHRyaWJ1dGUpIHtcbiAgICByZXR1cm4gY29uZGl0aW9uICYmIGlzU3RyaW5nKGF0dHJpYnV0ZSkgPyB0aGlzLnJlbW92ZUF0dHIoYXR0cmlidXRlKSA6IHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBhbiBhdHRyaWJ1dGUgdG8gdGhlIHRhZ1xuICAgKiBAcGFyYW0gIHtTdHJpbmd9IGF0dHJpYnV0ZSBUaGUgYXR0cmlidXRlIGtleVxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IHZhbHVlICAgICBUaGUgYXR0cmlidXRlIHZhbHVlXG4gICAqIEByZXR1cm4ge1RhZ30gICAgICAgICAgIFRoaXMgdGFnIGluc3RhbmNlXG4gICAqL1xuICBUYWcucHJvdG90eXBlLmFkZEF0dHIgPSBmdW5jdGlvbihhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgdmFyIGF0dHI7XG5cbiAgICBpZih0eXBlb2YgYXR0cmlidXRlID09PSAnb2JqZWN0Jykge1xuICAgICAgZm9yKGF0dHIgaW4gYXR0cmlidXRlKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGUuaGFzT3duUHJvcGVydHkoYXR0cikgJiYgIXRoaXMuYXR0cmlidXRlc1thdHRyXSkge1xuICAgICAgICAgIHRoaXMuYXR0cmlidXRlc1thdHRyXSA9IGF0dHJpYnV0ZVthdHRyXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBpZihpc1N0cmluZyhhdHRyaWJ1dGUpICYmIGlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgaWYoIXRoaXMuYXR0cmlidXRlc1thdHRyXSkge1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlXSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgYW4gYXR0cmlidXRlIHRvIHRoZSB0YWcgaWYgdGhlIHByb3ZpZGVkIGNvbmRpdGlvbiBpcyB0cnVlXG4gICAqIEBwYXJhbSAge0Jvb2xlYW59IGNvbmRpdGlvbiBUaGUgY29uZGl0aW9uXG4gICAqIEBwYXJhbSAge1N0cmluZ30gYXR0cmlidXRlIFRoZSBhdHRyaWJ1dGUga2V5XG4gICAqIEBwYXJhbSAge1N0cmluZ30gdmFsdWUgICAgIFRoZSBhdHRyaWJ1dGUgdmFsdWVcbiAgICogQHJldHVybiB7VGFnfSAgICAgICAgICAgVGhpcyB0YWcgaW5zdGFuY2VcbiAgICovXG4gIFRhZy5wcm90b3R5cGUuYWRkQXR0cklmID0gZnVuY3Rpb24oY29uZGl0aW9uLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgcmV0dXJuIGNvbmRpdGlvbiA/IHRoaXMuYWRkQXR0cihhdHRyaWJ1dGUsIHZhbHVlKSA6IHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZHMgdGhlIHByb3ZpZGVkIGNsYXNzIGlmIHRoZSBwcm92aWRlZCBjb25kaXRpb24gaXMgdHJ1ZVxuICAgKiBAcGFyYW0gIHtCb29sZWFufSBjb25kaXRpb24gVGhlIGNvbmRpdGlvblxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IGNsYXNzTmFtZSBUaGUgY2xhc3MgdG8gYWRkIHRvIHRoZSB0YWdcbiAgICogQHJldHVybiB7VGFnfSAgICAgICAgICAgVGhpcyB0YWcgaW5zdGFuY2VcbiAgICovXG4gIFRhZy5wcm90b3R5cGUuYWRkQ2xhc3NJZiA9IGZ1bmN0aW9uKGNvbmRpdGlvbiwgY2xhc3NOYW1lKSB7XG4gICAgcmV0dXJuIGNvbmRpdGlvbiA/IHRoaXMuYWRkQ2xhc3MoY2xhc3NOYW1lKSA6IHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbmRlcnMgdGhlIHRhZyBhbmQgaXRzIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5IGludG8gZWl0aGVyIGEgc3RyaW5nIG9mIHRleHRcbiAgICogb3IgYW4gSFRNTEVsZW1lbnQgY29tcG9zZWQgdGhyb3VnaCBhIERPTUZyYWdtZW50LlxuICAgKiBAcGFyYW0gIHtPYmplY3R9IGNvbmZpZyBBbiBvYmplY3Qgb2YgcGFyYW1zIGZvciBjdXN0b21pemluZyBob3cgdGhlIHRhZ1xuICAgKiB3aWxsIHJlbmRlci4gQ3VycmVudGx5LCBvbmx5IG9uZSBwYXJhbSBpcyBzdXBwb3J0ZWQ6XG4gICAqICAgb3B0aW9uczoge1xuICAgKiAgIFx0IGZvcm1hdDogJ1N0cmluZyB8IEhUTUxFbGVtZW50J1xuICAgKiAgIH1cbiAgICogQHJldHVybiB7U3RyaW5nfEhUTUxFbGVtZW50fSAgICAgICAgVGhlIHJlc3VsdGluZyBzdHJpbmcgfHwgSFRNTEVsZW1lbnRcbiAgICovXG4gIFRhZy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oY29uZmlnKXtcbiAgICB2YXIgaW5uZXJIdG1sID0gJycsXG4gICAgICBvcHRpb25zID0gY29uZmlnIHx8IHtcbiAgICAgICAgZm9ybWF0OiAnSFRNTEVsZW1lbnQnXG4gICAgICB9LFxuICAgICAgaSxcbiAgICAgIGosXG4gICAgICBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzLFxuICAgICAgbWFya3VwID0gWyc8JywgdGhpcy5uYW1lXSxcbiAgICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbixcbiAgICAgIGF0dHJpYnV0ZSxcbiAgICAgIGlzU2VsZkNsb3NpbmcgPSBTRUxGX0NMT1NJTkdfVEFHUy50ZXN0KHRoaXMubmFtZSk7XG5cbiAgICBpZigod2luZG93ICYmIHdpbmRvdy5kb2N1bWVudCkgJiYgb3B0aW9ucy5mb3JtYXQgPT09ICdIVE1MRWxlbWVudCcpIHtcbiAgICAgIHJldHVybiByZW5kZXJET01GcmFnbWVudCh0aGlzKTtcbiAgICB9XG5cbiAgICBpZihhdHRyaWJ1dGVzKSB7XG4gICAgICBmb3IgKGF0dHJpYnV0ZSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmKGF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoYXR0cmlidXRlKSAmJiBhdHRyaWJ1dGVzW2F0dHJpYnV0ZV0pIHtcbiAgICAgICAgICBtYXJrdXAucHVzaCgnICcsIGF0dHJpYnV0ZSwgJz1cIicsIGF0dHJpYnV0ZXNbYXR0cmlidXRlXSwgJ1wiJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZihpc1NlbGZDbG9zaW5nKSB7XG4gICAgICBtYXJrdXAucHVzaCgnIC8+Jyk7XG5cbiAgICAgIGlmKGNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBbJ05lc3RlZCBjb250ZW50IHdhcyBwcm92aWRlZCBmb3IgdGhlIHRhZyBuYW1lOiAnLCB0aGlzLm5hbWVdLmpvaW4oJycpO1xuICAgICAgfVxuXG4gICAgfSBlbHNlIHtcbiAgICAgIG1hcmt1cC5wdXNoKCc+Jyk7XG5cbiAgICAgIGZvciAoaSA9IDAsIGogPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBqOyBpICs9IDEpIHtcbiAgICAgICAgLy8gQWNjb3VudGluZyBmb3IgYWxyZWFkeSByZW5kZXJlZCB0YWdzXG4gICAgICAgIGlubmVySHRtbCArPSB0eXBlb2YgY2hpbGRyZW5baV0gPT09ICdzdHJpbmcnID8gY2hpbGRyZW5baV0gOiBjaGlsZHJlbltpXS5yZW5kZXIoKTtcbiAgICAgIH1cblxuICAgICAgaWYodGhpcy5pbm5lclRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBtYXJrdXAucHVzaCh0aGlzLmlubmVyVGV4dCk7XG4gICAgICB9XG5cbiAgICAgIGlmKGlubmVySHRtbC5sZW5ndGggPiAwKSB7XG4gICAgICAgIG1hcmt1cC5wdXNoKGlubmVySHRtbCk7XG4gICAgICB9XG5cbiAgICAgIG1hcmt1cC5wdXNoKFsnPC8nLCB0aGlzLm5hbWUsICc+J10uam9pbignJykpO1xuICAgIH1cblxuICAgIHJldHVybiBtYXJrdXAuam9pbignJyk7XG4gIH07XG5cbiAgcmV0dXJuIGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgaWYoIWlzU3RyaW5nKHNlbGVjdG9yKSkge1xuICAgICAgdGhyb3cgJ1RoZSBzZWxlY3RvciBwcm92aWRlZCBkb2VzIG5vdCBzdXBwbHkgYSB2YWxpZCB0YWcnO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgVGFnKHNlbGVjdG9yKTtcbiAgfTtcbn0oKSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
