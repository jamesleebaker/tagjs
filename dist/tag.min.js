var Tag=function(){function t(t){var e,r,n,i={};if(!t||t.length<1)return i;for(r=0,n=t.length;n>r;r+=1)e=t[r].replace(/['\"\[\]]/g,"").split("="),i[e[0]]=e[1];return i}function e(e){var r="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",n="[\\x20\\t\\r\\n\\f]",i=r.replace("w","w#"),s=e.match(new RegExp("("+r.replace("w","w*")+")")),o=e.match(new RegExp("\\.("+r+")","g")),a=e.match(new RegExp("#("+r+")")),h=e.match(new RegExp("\\["+n+"*("+r+")"+n+"*(?:([*^$|!~]?=)"+n+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+i+")|)|)"+n+"*\\]","g"));if(!s)throw"The selector provided does not supply a valid tag";return h=t(h),o=!o||o.length<1?"":o.join(" ").replace(/\./g,""),a=a?a[0].replace("#",""):void 0,o&&(h["class"]=o),a&&(h.id=a),{tag:s[0],attributes:h}}function r(t,e){var r=e.attributes;for(var n in r){var i=r[n];i&&t.setAttribute(n,i)}return t}function n(t){var e=document.createElement(t.name),i=document.createDocumentFragment();return t.children.length?(t.children.forEach(function(t){i.appendChild(n(t))}),e.appendChild(i)):e.innerText=t.innerText,r(e,t)}var i,s=/area|base|basefont|br|hr|input|img|link|meta/;return i=function(t){var r=e(t);this.name=r.tag,this.attributes=r.attributes,this.innerText="",this.children=[]},i.prototype.add=function(){var t,e,r=Array.prototype.slice.call(arguments);if(r.length)for(t=0,e=r.length;e>t;t+=1)this.children.push(r[t]);return this},i.prototype.getAttr=function(t){return this.attributes[t]},i.prototype.setAttr=function(t){return t&&(this.attributes[t]=t),this},i.prototype.addIf=function(t,e){return t?this.add(e):this},i.prototype.setText=function(t){return this.innerText=String(t),this},i.prototype.addClass=function(t){var e=this.attributes["class"];return-1===e.indexOf(t)&&(this.attributes["class"]+=[" ",t].join("")),this},i.prototype.removeClass=function(t){var e=this.attributes["class"],r=e.indexOf(t);return r>-1&&(e=e.split(" "),e.splice(r,1),this.attributes["class"]=e.join(" ")),this},i.prototype.removeClassIf=function(t,e){return t?this.removeClass(e):this},i.prototype.removeAttr=function(t){return delete this.attributes[t],this},i.prototype.removeAttrIf=function(t,e){return t?this.removeAttr(e):this},i.prototype.addAttr=function(t,e){var r;if("object"==typeof t){for(r in t)t.hasOwnProperty(r)&&!this.attributes[r]&&(this.attributes[r]=t[r]);return this}return this.attributes[t]=e,this},i.prototype.addAttrIf=function(t,e,r){return t?this.addAttr(e,r):this},i.prototype.addClassIf=function(t,e){return t?this.addClass(e):this},i.prototype.render=function(){var t,e,r,i="",o=this.attributes,a=["<",this.name],h=this.children,u=s.test(this.name);if(window&&window.document)return n(this);if(o)for(r in o)o.hasOwnProperty(r)&&o[r]&&a.push(" ",r,'="',o[r],'"');if(u){if(a.push(" />"),h.length)throw["Nested content was provided for the tag name: ",this.name].join("")}else{for(a.push(">"),t=0,e=h.length;e>t;t+=1)i+="string"==typeof h[t]?h[t]:h[t].render();this.innerText.length>0&&a.push(this.innerText),i.length>0&&a.push(i),a.push(["</",this.name,">"].join(""))}return a.join("")},function(t){return new i(t)}}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhZy5qcyJdLCJuYW1lcyI6WyJUYWciLCJ0b2tlbml6ZUF0dHJpYnV0ZXMiLCJhdHRycyIsInNwbGl0IiwiaSIsImoiLCJhdHRyaWJ1dGVzIiwibGVuZ3RoIiwicmVwbGFjZSIsInBhcnNlU2VsZWN0b3IiLCJzZWxlY3RvciIsImNoYXJhY3RlckVuY29kaW5nIiwid2hpdGVzcGFjZSIsImlkZW50aWZpZXIiLCJ0YWciLCJtYXRjaCIsIlJlZ0V4cCIsImNsYXNzZXMiLCJpZCIsImpvaW4iLCJ1bmRlZmluZWQiLCJzZXRFbGVtZW50QXR0cmlidXRlcyIsImVsZW1lbnQiLCJhdHRyIiwidmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJET01GcmFnbWVudCIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm5hbWUiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJjaGlsZHJlbiIsImZvckVhY2giLCJjaGlsZCIsImFwcGVuZENoaWxkIiwiaW5uZXJUZXh0IiwiU0VMRl9DTE9TSU5HX1RBR1MiLCJlbGVtZW50VG9rZW5zIiwidGhpcyIsInByb3RvdHlwZSIsImFkZCIsImFyZ3MiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImFyZ3VtZW50cyIsInB1c2giLCJnZXRBdHRyIiwic2V0QXR0ciIsImFkZElmIiwiY29uZGl0aW9uIiwic2V0VGV4dCIsInRleHQiLCJTdHJpbmciLCJhZGRDbGFzcyIsImNsYXNzTmFtZSIsImNsYXNzQXR0ciIsImluZGV4T2YiLCJyZW1vdmVDbGFzcyIsImF0dHJJbmRleCIsInNwbGljZSIsInJlbW92ZUNsYXNzSWYiLCJyZW1vdmVBdHRyIiwiYXR0cmlidXRlIiwicmVtb3ZlQXR0cklmIiwiYWRkQXR0ciIsImhhc093blByb3BlcnR5IiwiYWRkQXR0cklmIiwiYWRkQ2xhc3NJZiIsInJlbmRlciIsImlubmVySHRtbCIsIm1hcmt1cCIsImlzU2VsZkNsb3NpbmciLCJ0ZXN0Iiwid2luZG93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QUlWLEdBQUlVIiwiZmlsZSI6InRhZy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmpzbGludCBzbG9wcHk6IHRydWUsIHRvZG86IHRydWUsIHdoaXRlOiB0cnVlICovXG52YXIgVGFnID0gKGZ1bmN0aW9uKCl7XG4gIHZhciBTRUxGX0NMT1NJTkdfVEFHUyA9IC9hcmVhfGJhc2V8YmFzZWZvbnR8YnJ8aHJ8aW5wdXR8aW1nfGxpbmt8bWV0YS8sXG4gIFRhZztcblxuICBmdW5jdGlvbiB0b2tlbml6ZUF0dHJpYnV0ZXMoYXR0cnMpIHtcbiAgICB2YXIgYXR0cmlidXRlcyA9IHt9LFxuICAgICAgc3BsaXQsXG4gICAgICBpLFxuICAgICAgajtcblxuICAgIGlmKCFhdHRycyB8fCBhdHRycy5sZW5ndGggPCAxKSB7XG4gICAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgICB9XG5cbiAgICBmb3IgKGkgPSAwLCBqID0gYXR0cnMubGVuZ3RoOyBpIDwgajsgaSArPSAxKSB7XG4gICAgICBzcGxpdCA9IGF0dHJzW2ldLnJlcGxhY2UoL1snXFxcIlxcW1xcXV0vZywgJycpLnNwbGl0KCc9Jyk7XG4gICAgICBhdHRyaWJ1dGVzW3NwbGl0WzBdXSA9IHNwbGl0WzFdO1xuICAgIH1cblxuICAgIHJldHVybiBhdHRyaWJ1dGVzO1xuICB9XG5cbiAgZnVuY3Rpb24gcGFyc2VTZWxlY3RvcihzZWxlY3Rvcikge1xuICAgIHZhciBjaGFyYWN0ZXJFbmNvZGluZyA9ICcoPzpcXFxcXFxcXC58W1xcXFx3LV18W15cXFxceDAwLVxcXFx4YTBdKSsnLFxuICAgICAgd2hpdGVzcGFjZSA9ICdbXFxcXHgyMFxcXFx0XFxcXHJcXFxcblxcXFxmXScsXG4gICAgICBpZGVudGlmaWVyID0gY2hhcmFjdGVyRW5jb2RpbmcucmVwbGFjZSgndycsICd3IycpLFxuICAgICAgdGFnID0gc2VsZWN0b3IubWF0Y2gobmV3IFJlZ0V4cCgnKCcgKyBjaGFyYWN0ZXJFbmNvZGluZy5yZXBsYWNlKCd3JywgJ3cqJyApICsgJyknKSksXG4gICAgICAvL1RPRE86IENsYXNzZXMgUmVnRXggbmVlZHMgdG8gYWNjb3VudCBmb3IgVVJMcyBhbmQgb3RoZXIgJ3BlcmlvZHMnIGluIHRoZSBzZWxlY3RvciB0aGF0IGFyZW4ndCBjbGFzc2VzXG4gICAgICBjbGFzc2VzID0gc2VsZWN0b3IubWF0Y2gobmV3IFJlZ0V4cCgnXFxcXC4oJyArIGNoYXJhY3RlckVuY29kaW5nICsgJyknLCAnZycpKSxcbiAgICAgIGlkID0gc2VsZWN0b3IubWF0Y2gobmV3IFJlZ0V4cCggJyMoJyArIGNoYXJhY3RlckVuY29kaW5nICsgJyknKSksXG4gICAgICBhdHRyaWJ1dGVzID0gc2VsZWN0b3IubWF0Y2gobmV3IFJlZ0V4cCggXCJcXFxcW1wiICsgd2hpdGVzcGFjZSArIFwiKihcIiArIGNoYXJhY3RlckVuY29kaW5nICsgXCIpXCIgKyB3aGl0ZXNwYWNlICsgXCIqKD86KFsqXiR8IX5dPz0pXCIgKyB3aGl0ZXNwYWNlICsgXCIqKD86KFsnXFxcIl0pKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcXSkqPylcXFxcM3woXCIgKyBpZGVudGlmaWVyICsgXCIpfCl8KVwiICsgd2hpdGVzcGFjZSArIFwiKlxcXFxdXCIsIFwiZ1wiKSk7XG5cbiAgICBpZighdGFnKSB7XG4gICAgICB0aHJvdyAnVGhlIHNlbGVjdG9yIHByb3ZpZGVkIGRvZXMgbm90IHN1cHBseSBhIHZhbGlkIHRhZyc7XG4gICAgfVxuXG4gICAgYXR0cmlidXRlcyA9IHRva2VuaXplQXR0cmlidXRlcyhhdHRyaWJ1dGVzKTtcbiAgICBjbGFzc2VzID0gIWNsYXNzZXMgfHwgY2xhc3Nlcy5sZW5ndGggPCAxID8gJycgOiBjbGFzc2VzLmpvaW4oJyAnKS5yZXBsYWNlKC9cXC4vZywgJycpO1xuICAgIGlkID0gIWlkID8gdW5kZWZpbmVkIDogaWRbMF0ucmVwbGFjZSgnIycsICcnKTtcblxuICAgIGlmKGNsYXNzZXMpIHtcbiAgICAgIGF0dHJpYnV0ZXNbJ2NsYXNzJ10gPSBjbGFzc2VzO1xuICAgIH1cblxuICAgIGlmKGlkKSB7XG4gICAgICBhdHRyaWJ1dGVzWydpZCddID0gaWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRhZyA6IHRhZ1swXSxcbiAgICAgIGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZXNcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0RWxlbWVudEF0dHJpYnV0ZXMoZWxlbWVudCwgdGFnKSB7XG4gICAgdmFyIGF0dHJpYnV0ZXMgPSB0YWcuYXR0cmlidXRlcztcblxuICAgIGZvcih2YXIgYXR0ciBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhdHRyaWJ1dGVzW2F0dHJdO1xuXG4gICAgICBpZih2YWx1ZSkge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH1cblxuICBmdW5jdGlvbiByZW5kZXJET01GcmFnbWVudCh0YWcpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcubmFtZSksXG4gICAgICBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblxuICAgIGlmKCF0YWcuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICBjb250YWluZXIuaW5uZXJUZXh0ID0gdGFnLmlubmVyVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFnLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQocmVuZGVyRE9NRnJhZ21lbnQoY2hpbGQpKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgIH1cblxuICAgIHJldHVybiBzZXRFbGVtZW50QXR0cmlidXRlcyhjb250YWluZXIsIHRhZyk7XG4gIH1cblxuICBUYWcgPSBmdW5jdGlvbihzZWxlY3Rvcil7XG4gICAgdmFyIGVsZW1lbnRUb2tlbnMgPSBwYXJzZVNlbGVjdG9yKHNlbGVjdG9yKTtcblxuICAgIHRoaXMubmFtZSA9IGVsZW1lbnRUb2tlbnMudGFnO1xuICAgIHRoaXMuYXR0cmlidXRlcyA9IGVsZW1lbnRUb2tlbnMuYXR0cmlidXRlcztcbiAgICB0aGlzLmlubmVyVGV4dCA9ICcnO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgfTtcblxuICAvL1RPRE86IFByb3ZpZGUgYSB3YXkgdG8gcGFzcyBpbiBhdHRyaWJ1dGVzIGFzIHBhcmFtc1xuICBUYWcucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLFxuICAgICAgaSwgajtcblxuICAgIGlmKGFyZ3MubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBqID0gYXJncy5sZW5ndGg7IGkgPCBqOyBpICs9IDEpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKGFyZ3NbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFRhZy5wcm90b3R5cGUuZ2V0QXR0ciA9IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGVzW2F0dHJdO1xuICB9O1xuXG4gIFRhZy5wcm90b3R5cGUuc2V0QXR0ciA9IGZ1bmN0aW9uKGF0dHIpIHtcbiAgICBpZihhdHRyKSB7XG4gICAgICB0aGlzLmF0dHJpYnV0ZXNbYXR0cl0gPSBhdHRyO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFRhZy5wcm90b3R5cGUuYWRkSWYgPSBmdW5jdGlvbihjb25kaXRpb24sIHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIGNvbmRpdGlvblxuICAgICAgPyB0aGlzLmFkZChzZWxlY3RvcilcbiAgICAgIDogdGhpcztcbiAgfTtcblxuICBUYWcucHJvdG90eXBlLnNldFRleHQgPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgdGhpcy5pbm5lclRleHQgPSBTdHJpbmcodGV4dCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgVGFnLnByb3RvdHlwZS5hZGRDbGFzcyA9IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICAgIHZhciBjbGFzc0F0dHIgPSB0aGlzLmF0dHJpYnV0ZXNbJ2NsYXNzJ107XG5cbiAgICBpZihjbGFzc0F0dHIuaW5kZXhPZihjbGFzc05hbWUpID09PSAtMSkge1xuICAgICAgdGhpcy5hdHRyaWJ1dGVzWydjbGFzcyddICs9IFsnICcsIGNsYXNzTmFtZV0uam9pbignJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgVGFnLnByb3RvdHlwZS5yZW1vdmVDbGFzcyA9IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xuICAgIHZhciBjbGFzc2VzID0gdGhpcy5hdHRyaWJ1dGVzWydjbGFzcyddLFxuICAgICAgYXR0ckluZGV4ID0gY2xhc3Nlcy5pbmRleE9mKGNsYXNzTmFtZSk7XG5cbiAgICBpZihhdHRySW5kZXggPiAtMSkge1xuICAgICAgY2xhc3NlcyA9IGNsYXNzZXMuc3BsaXQoJyAnKTtcbiAgICAgIGNsYXNzZXMuc3BsaWNlKGF0dHJJbmRleCwgMSk7XG4gICAgICB0aGlzLmF0dHJpYnV0ZXNbJ2NsYXNzJ10gPSBjbGFzc2VzLmpvaW4oJyAnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBUYWcucHJvdG90eXBlLnJlbW92ZUNsYXNzSWYgPSBmdW5jdGlvbihjb25kaXRpb24sIGNsYXNzTmFtZSkge1xuICAgIHJldHVybiBjb25kaXRpb25cbiAgICAgID8gdGhpcy5yZW1vdmVDbGFzcyhjbGFzc05hbWUpXG4gICAgICA6IHRoaXM7XG4gIH07XG5cbiAgVGFnLnByb3RvdHlwZS5yZW1vdmVBdHRyID0gZnVuY3Rpb24oYXR0cmlidXRlKSB7XG4gICAgZGVsZXRlIHRoaXMuYXR0cmlidXRlc1thdHRyaWJ1dGVdO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFRhZy5wcm90b3R5cGUucmVtb3ZlQXR0cklmID0gZnVuY3Rpb24oY29uZGl0aW9uLCBhdHRyaWJ1dGUpIHtcbiAgICByZXR1cm4gY29uZGl0aW9uXG4gICAgICA/IHRoaXMucmVtb3ZlQXR0cihhdHRyaWJ1dGUpXG4gICAgICA6IHRoaXM7XG4gIH07XG5cbiAgVGFnLnByb3RvdHlwZS5hZGRBdHRyID0gZnVuY3Rpb24oYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIHZhciBhdHRyO1xuXG4gICAgaWYodHlwZW9mIGF0dHJpYnV0ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGZvcihhdHRyIGluIGF0dHJpYnV0ZSkge1xuICAgICAgICBpZiAoYXR0cmlidXRlLmhhc093blByb3BlcnR5KGF0dHIpICYmICF0aGlzLmF0dHJpYnV0ZXNbYXR0cl0pIHtcbiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXNbYXR0cl0gPSBhdHRyaWJ1dGVbYXR0cl07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdGhpcy5hdHRyaWJ1dGVzW2F0dHJpYnV0ZV0gPSB2YWx1ZTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIFRhZy5wcm90b3R5cGUuYWRkQXR0cklmID0gZnVuY3Rpb24oY29uZGl0aW9uLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgcmV0dXJuIGNvbmRpdGlvblxuICAgICAgPyB0aGlzLmFkZEF0dHIoYXR0cmlidXRlLCB2YWx1ZSlcbiAgICAgIDogdGhpcztcbiAgfTtcblxuICBUYWcucHJvdG90eXBlLmFkZENsYXNzSWYgPSBmdW5jdGlvbihjb25kaXRpb24sIGNsYXNzTmFtZSkge1xuICAgIHJldHVybiBjb25kaXRpb25cbiAgICAgID8gdGhpcy5hZGRDbGFzcyhjbGFzc05hbWUpXG4gICAgICA6IHRoaXM7XG4gIH07XG5cbiAgVGFnLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpe1xuICAgIHZhciBpbm5lckh0bWwgPSAnJyxcbiAgICAgIGksXG4gICAgICBqLFxuICAgICAgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyxcbiAgICAgIG1hcmt1cCA9IFsnPCcsIHRoaXMubmFtZV0sXG4gICAgICBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4sXG4gICAgICBhdHRyaWJ1dGUsXG4gICAgICBpc1NlbGZDbG9zaW5nID0gU0VMRl9DTE9TSU5HX1RBR1MudGVzdCh0aGlzLm5hbWUpO1xuXG4gICAgaWYod2luZG93ICYmIHdpbmRvdy5kb2N1bWVudCkge1xuICAgICAgcmV0dXJuIHJlbmRlckRPTUZyYWdtZW50KHRoaXMpO1xuICAgIH1cblxuICAgIGlmKGF0dHJpYnV0ZXMpIHtcbiAgICAgIGZvciAoYXR0cmlidXRlIGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgaWYoYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShhdHRyaWJ1dGUpICYmIGF0dHJpYnV0ZXNbYXR0cmlidXRlXSkge1xuICAgICAgICAgIG1hcmt1cC5wdXNoKCcgJywgYXR0cmlidXRlLCAnPVwiJywgYXR0cmlidXRlc1thdHRyaWJ1dGVdLCAnXCInKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmKGlzU2VsZkNsb3NpbmcpIHtcbiAgICAgIG1hcmt1cC5wdXNoKCcgLz4nKTtcblxuICAgICAgaWYoY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IFsnTmVzdGVkIGNvbnRlbnQgd2FzIHByb3ZpZGVkIGZvciB0aGUgdGFnIG5hbWU6ICcsIHRoaXMubmFtZV0uam9pbignJyk7XG4gICAgICB9XG5cbiAgICB9IGVsc2Uge1xuICAgICAgbWFya3VwLnB1c2goJz4nKTtcblxuICAgICAgZm9yIChpID0gMCwgaiA9IGNoaWxkcmVuLmxlbmd0aDsgaSA8IGo7IGkgKz0gMSkge1xuICAgICAgICAvLyBBY2NvdW50aW5nIGZvciBhbHJlYWR5IHJlbmRlcmVkIHRhZ3NcbiAgICAgICAgaW5uZXJIdG1sICs9IHR5cGVvZiBjaGlsZHJlbltpXSA9PT0gJ3N0cmluZydcbiAgICAgICAgICA/IGNoaWxkcmVuW2ldXG4gICAgICAgICAgOiBjaGlsZHJlbltpXS5yZW5kZXIoKTtcbiAgICAgIH1cblxuICAgICAgaWYodGhpcy5pbm5lclRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBtYXJrdXAucHVzaCh0aGlzLmlubmVyVGV4dCk7XG4gICAgICB9XG5cbiAgICAgIGlmKGlubmVySHRtbC5sZW5ndGggPiAwKSB7XG4gICAgICAgIG1hcmt1cC5wdXNoKGlubmVySHRtbCk7XG4gICAgICB9XG5cbiAgICAgIG1hcmt1cC5wdXNoKFsnPC8nLCB0aGlzLm5hbWUsICc+J10uam9pbignJykpO1xuICAgIH1cblxuICAgIHJldHVybiBtYXJrdXAuam9pbignJyk7XG4gIH07XG5cbiAgcmV0dXJuIGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIG5ldyBUYWcoc2VsZWN0b3IpO1xuICB9O1xufSgpKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
