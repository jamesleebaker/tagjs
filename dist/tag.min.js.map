{"version":3,"sources":["tag.js"],"names":["Tag","isString","str","trim","length","tokenizeAttributes","attrs","split","i","j","attributes","replace","parseSelector","selector","characterEncoding","whitespace","identifier","tag","match","RegExp","classes","id","join","undefined","setElementAttributes","element","attr","value","setAttribute","renderDOMFragment","container","document","createElement","name","fragment","createDocumentFragment","children","forEach","child","appendChild","innerText","wrapper","SELF_CLOSING_TAGS","root","self","global","this","elementTokens","prototype","add","args","Array","slice","call","arguments","push","getAttr","setAttr","addIf","condition","setText","text","String","addClass","className","classAttr","indexOf","removeClass","attrIndex","splice","removeClassIf","removeAttr","attribute","removeAttrIf","addAttr","hasOwnProperty","addAttrIf","addClassIf","render","config","innerHtml","options","format","markup","isSelfClosing","test","window","exports","nodeType","module","define","amd"],"mappings":"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","file":"tag.min.js","sourcesContent":["var Tag = (function(){\n  var SELF_CLOSING_TAGS = /area|base|basefont|br|hr|input|img|link|meta/,\n  Tag,\n  root = typeof self == 'object' && self.self === self && self ||\n    typeof global == 'object' && global.global === global && global ||\n    this;\n\n  /**\n   * Determines if an argument is of type string and has a valid length\n   * @private\n   * @param  {String}  str A string of text\n   * @return {Boolean}\n   */\n  function isString(str) {\n    return typeof str === 'string' && str.trim().length > 0;\n  }\n\n  /**\n   * @private\n   * Transforms an array of DOM-style attributes(e.g. class=\"foo\") to a hash table\n   * @param  {String[]} attrs An array of DOM-style attributes\n   * @return {Object}\n   */\n  function tokenizeAttributes(attrs) {\n    var attributes = {},\n      split,\n      i,\n      j;\n\n    if(!attrs || attrs.length < 1) {\n      return attributes;\n    }\n\n    for (i = 0, j = attrs.length; i < j; i += 1) {\n      split = attrs[i].replace(/['\\\"\\[\\]]/g, '').split('=');\n      attributes[split[0]] = split[1];\n    }\n\n    return attributes;\n  }\n\n  /**\n   * @private\n   * Meticulously parses the CSS-style selector provided and produces an Object\n   * consisting of a tag name and the provided attributes\n   * @param  {String} selector The original CSS-style (Sizzle-style) selector\n   * @return {Object}          The transformed meta object for the selector\n   */\n  function parseSelector(selector) {\n    var characterEncoding = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+',\n      whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]',\n      identifier = characterEncoding.replace('w', 'w#'),\n      tag = selector.match(new RegExp('(' + characterEncoding.replace('w', 'w*' ) + ')')),\n      //TODO: Classes RegEx needs to account for URLs and other 'periods' in the selector that aren't classes\n      classes = selector.match(new RegExp('\\\\.(' + characterEncoding + ')', 'g')),\n      id = selector.match(new RegExp( '#(' + characterEncoding + ')')),\n      attributes = selector.match(new RegExp( \"\\\\[\" + whitespace + \"*(\" + characterEncoding + \")\" + whitespace + \"*(?:([*^$|!~]?=)\" + whitespace + \"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\" + identifier + \")|)|)\" + whitespace + \"*\\\\]\", \"g\"));\n\n    attributes = tokenizeAttributes(attributes);\n    classes = !classes || classes.length < 1 ? '' : classes.join(' ').replace(/\\./g, '');\n    id = !id ? undefined : id[0].replace('#', '');\n\n    if(classes) {\n      attributes['class'] = classes;\n    }\n\n    if(id) {\n      attributes.id = id;\n    }\n\n    return {\n      tag : tag[0],\n      attributes: attributes\n    };\n  }\n\n  /**\n   * Adds the provided DOM attributes to the element from the provided tag's meta information\n   * @private\n   * @param {HTMLElement} element\n   * @param {HTMLElement} tag\n   */\n  function setElementAttributes(element, tag) {\n    var attributes = tag.attributes;\n\n    for(var attr in attributes) {\n      var value = attributes[attr];\n\n      if(value) {\n        element.setAttribute(attr, value);\n      }\n    }\n\n    return element;\n  }\n\n  /**\n   * Renders an HTMLELement-version of the tag and any children, recursively.\n   * @private\n   * @param  {tag} tag An instance of the Tag object\n   * @return {HTMLElement}     The resulting HTMLElement\n   */\n  function renderDOMFragment(tag) {\n    var container = document.createElement(tag.name),\n      fragment = document.createDocumentFragment();\n\n    if(!tag.children.length) {\n      container.innerText = tag.innerText;\n    } else {\n      tag.children.forEach(function(child) {\n        fragment.appendChild(renderDOMFragment(child));\n      });\n\n      container.appendChild(fragment);\n    }\n\n    return setElementAttributes(container, tag);\n  }\n\n  /**\n   * C'tor\n   @constructor\n   * @param  {String} selector The CSS-style selector that defines the tag to be\n   * created\n   * @return {Object}          The meta object representing the tag\n   */\n  Tag = function(selector){\n    var elementTokens = parseSelector(selector);\n\n    this.name = elementTokens.tag;\n    this.attributes = elementTokens.attributes;\n    this.innerText = '';\n    this.children = [];\n  };\n\n  /**\n   * Adds a child tag to the tag\n   * @return {Tag} This tag instance\n   */\n  Tag.prototype.add = function(){\n    var args = Array.prototype.slice.call(arguments),\n      i, j;\n\n    if(args.length) {\n      for (i = 0, j = args.length; i < j; i += 1) {\n        this.children.push(args[i]);\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Returns the current value of the provided attribute\n   * @param  {String} attr The attribute key\n   * @return {String}      The value of the attribute\n   */\n  Tag.prototype.getAttr = function(attr) {\n    if(isString(attr)) {\n      return this.attributes[attr];\n    }\n  };\n\n  /**\n   * Sets the value of the provided attribute. Unlike Tag.prototype.addAttr,\n   * This method is destructive.\n   * @param  {String} attr  The attribute key to add to the Tag\n   * @param  {String} value The value of the attribute to add to the Tag\n   * @return {tag}       This instance of the tag\n   */\n  Tag.prototype.setAttr = function(attr, value) {\n    if(isString(attr) && isString(value)) {\n      this.attributes[attr] = value;\n    }\n\n    return this;\n  };\n\n  /**\n   * If the provided condition is true, add the child tag\n   * @param  {Boolean} condition  The condition\n   * @param  {Tag} tag            The instance of the child tag\n   * @return {Tag}                This current tag instance\n   */\n  Tag.prototype.addIf = function(condition, tag) {\n    if(tag instanceof Tag) {\n      return condition ? this.add(tag) : this;\n    }\n  };\n\n  /**\n   * Sets the innerText of the tag. Useful for elements with no children\n   * who have a text value\n   * @param  {String} text The text value of the tag\n   * @return {Tag}      This instance of the tag\n   */\n  Tag.prototype.setText = function(text) {\n    this.innerText = String(text);\n    return this;\n  };\n\n  /**\n   * Add a CSS class to the tag\n   * @param  {String} className The CSS class name\n   * @return {Tag}           This instance of the tag\n   */\n  Tag.prototype.addClass = function(className) {\n    var classAttr = this.attributes['class'];\n\n    if(classAttr.indexOf(className) === -1) {\n      this.attributes['class'] += [' ', className].join('');\n    }\n\n    return this;\n  };\n\n  /**\n   * Removes a CSS class from the tag\n   * @param  {String} className The CSS class name\n   * @return {Tag}           This instance of the tag\n   */\n  Tag.prototype.removeClass = function(className) {\n    var classes = this.attributes['class'],\n      attrIndex;\n\n    if(!isString(className)) {\n      return this;\n    }\n\n    if(isString(classes)) {\n      classes = classes.split(' ');\n      attrIndex = classes.indexOf(className);\n\n       if(attrIndex > -1) {\n         classes.splice(attrIndex, 1);\n         this.attributes['class'] = classes.join(' ');\n       }\n    }\n\n    return this;\n  };\n\n  /**\n   * Remove the CSS class if the provided condition is true\n   * @param  {Boolean} condition The condition\n   * @param  {String} className The class name to remove from the tag\n   * @return {Tag}           This instance of the class\n   */\n  Tag.prototype.removeClassIf = function(condition, className) {\n    return condition && isString(className) ? this.removeClass(className) : this;\n  };\n\n  /**\n   * Remove the provided attribute from the tag\n   * @param  {String} attribute The attribute key\n   * @return {Tag}           This tag instance\n   */\n  Tag.prototype.removeAttr = function(attribute) {\n    delete this.attributes[attribute];\n    return this;\n  };\n\n  /**\n   * Remove the provided attribute if the provided condition is true\n   * @param  {Boolean} condition The condition\n   * @param  {String} attribute The key of the attribute to remove\n   * @return {Tag}           This tag instance\n   */\n  Tag.prototype.removeAttrIf = function(condition, attribute) {\n    return condition && isString(attribute) ? this.removeAttr(attribute) : this;\n  };\n\n  /**\n   * Add an attribute to the tag\n   * @param  {String} attribute The attribute key\n   * @param  {String} value     The attribute value\n   * @return {Tag}           This tag instance\n   */\n  Tag.prototype.addAttr = function(attribute, value) {\n    var attr;\n\n    if(typeof attribute === 'object') {\n      for(attr in attribute) {\n        if (attribute.hasOwnProperty(attr) && !this.attributes[attr]) {\n          this.attributes[attr] = attribute[attr];\n        }\n      }\n\n      return this;\n    }\n\n    if(isString(attribute) && isString(value)) {\n      if(!this.attributes[attr]) {\n        this.attributes[attribute] = value;\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Add an attribute to the tag if the provided condition is true\n   * @param  {Boolean} condition The condition\n   * @param  {String} attribute The attribute key\n   * @param  {String} value     The attribute value\n   * @return {Tag}           This tag instance\n   */\n  Tag.prototype.addAttrIf = function(condition, attribute, value) {\n    return condition ? this.addAttr(attribute, value) : this;\n  };\n\n  /**\n   * Adds the provided class if the provided condition is true\n   * @param  {Boolean} condition The condition\n   * @param  {String} className The class to add to the tag\n   * @return {Tag}           This tag instance\n   */\n  Tag.prototype.addClassIf = function(condition, className) {\n    return condition ? this.addClass(className) : this;\n  };\n\n  /**\n   * Renders the tag and its children recursively into either a string of text\n   * or an HTMLElement composed through a DOMFragment.\n   * @param  {Object} config An object of params for customizing how the tag\n   * will render. Currently, only one param is supported:\n   *   options: {\n   *   \t format: 'String | HTMLElement'\n   *   }\n   * @return {String|HTMLElement}        The resulting string || HTMLElement\n   */\n  Tag.prototype.render = function(config){\n    var innerHtml = '',\n      options = config || {\n        format: 'HTMLElement'\n      },\n      i,\n      j,\n      attributes = this.attributes,\n      markup = ['<', this.name],\n      children = this.children,\n      attribute,\n      isSelfClosing = SELF_CLOSING_TAGS.test(this.name);\n\n    if((window && window.document) && options.format === 'HTMLElement') {\n      return renderDOMFragment(this);\n    }\n\n    if(attributes) {\n      for (attribute in attributes) {\n        if(attributes.hasOwnProperty(attribute) && attributes[attribute]) {\n          markup.push(' ', attribute, '=\"', attributes[attribute], '\"');\n        }\n      }\n    }\n\n    if(isSelfClosing) {\n      markup.push(' />');\n\n      if(children.length) {\n        throw ['Nested content was provided for the tag name: ', this.name].join('');\n      }\n\n    } else {\n      markup.push('>');\n\n      for (i = 0, j = children.length; i < j; i += 1) {\n        // Accounting for already rendered tags\n        innerHtml += typeof children[i] === 'string' ? children[i] : children[i].render();\n      }\n\n      if(this.innerText.length > 0) {\n        markup.push(this.innerText);\n      }\n\n      if(innerHtml.length > 0) {\n        markup.push(innerHtml);\n      }\n\n      markup.push(['</', this.name, '>'].join(''));\n    }\n\n    return markup.join('');\n  };\n\n  function wrapper(selector) {\n    if(!isString(selector)) {\n      throw 'The selector provided does not supply a valid tag';\n    }\n\n    return new Tag(selector);\n  };\n\n  // Support Node and simulators\n  if (typeof exports != 'undefined' && !exports.nodeType) {\n    if (typeof module != 'undefined' && !module.nodeType && module.exports) {\n      exports = module.exports = wrapper;\n    }\n    exports.Tag = wrapper;\n  } else {\n    root.Tag = wrapper;\n  }\n\n  // Support AMD\n  if (typeof define == 'function' && define.amd) {\n    define('tag', [], function() {\n      return wrapper;\n    });\n  }\n}());\n"],"sourceRoot":"/source/"}